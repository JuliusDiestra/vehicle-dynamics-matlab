function [dotX,A,B] = semitrailerLinearVxConstant(X,U,vx1,params)
%SEMITRAILERLINEARVXCONSTANT Linear state-space equation of semi-trailer with constant longitudinal velocity. Linearize around (0,0)
%    [DOTX,A,B] = SEMITRAILERLINEARVXCONSTANT(X,U,VX1,PARAMS)
%   Inputs:
%       X       : State vector = [vy1 d_psi1 d_deltaPsi1 psi1 deltaPsi1]
%                   vy1         : Car lateral velocity [m/s]
%                   d_psi1      : Inclination angle rate of Unit 1 w.r.t x-axis of Frame {E}. Unit: [rad/s]
%                   d_deltaPsi1 :  Angle rate between Unit 1 and Unit 2. Unit: [rad/s]
%                   psi1        : Inclination angle rate of Unit 1 w.r.t x-axis of Frame {E}. Unit: [rad/s]
%                   deltaPsi1   : Angle rate between Unit 1 and Unit 2. Unit: [rad]
%                      
%       U       : Input vector = [delta11 Fxw12]'
%                   delta11     : Steering-angle. Unit: [rad]
%       params  : Parameters = [Cy11 Cy12 Cy13 Cy21 Cy22 Cy23 l11 l12 l13 l21 l22 l23 l1c1 l2c1 m1 m2 J1 J2]'
%                   Cyjk        : Cornering stiffness of unit j wheel k. Unit: [N]                  
%                   ljk         : Distance between unit j axle k to Center of gravity of unit j. Unit: [m]                      
%                   ljck        : Distance between Center of Gravity of unit j to joint of unit k. Unit: [m]
%                   mj          : Mass of vehicle unit j
%                   Jj          : Inertia around z-axis of vehicle unit j. Unit: [Kg.m^2]
%   Outputs:
%       dotX    : Symbolic expression of dotX = dX/dt = [d_vx d_vy dd_psi]
%       A       : Matrix from linear expression dX/dt = A*X + B*U
%       B       : Matrix from linear expression dX/dt = A*X + B*U
%   Author : Julius D.

%    This function was generated by the Symbolic Math Toolbox version 8.5.
%    08-Aug-2020 11:16:44

delta11 = U;
Cy11 = params(:,1);
Cy12 = params(:,2);
Cy13 = params(:,3);
Cy21 = params(:,4);
Cy22 = params(:,5);
Cy23 = params(:,6);
J1 = params(:,17);
J2 = params(:,18);
d_deltaPsi1 = X(:,3);
d_psi1 = X(:,2);
deltaPsi1 = X(:,5);
l11 = params(:,7);
l12 = params(:,8);
l13 = params(:,9);
l21 = params(:,10);
l22 = params(:,11);
l23 = params(:,12);
l1c1 = params(:,13);
l2c1 = params(:,14);
m1 = params(:,15);
m2 = params(:,16);
vy1 = X(:,1);

t2 = l11.^2;
t3 = l12.^2;
t4 = l13.^2;
t5 = l21.^2;
t6 = l22.^2;
t7 = l23.^2;
t8 = l1c1.^2;
t9 = l1c1.^3;
t10 = l2c1.^2;
t11 = vx1.^2;
t12 = Cy21.*J2;
t13 = Cy22.*J2;
t14 = Cy23.*J2;
t21 = J1.*J2.*m1;
t22 = J1.*J2.*m2;
t23 = J2.*l11.*m1;
t24 = J2.*l11.*m2;
t25 = J2.*l1c1.*m2;
t26 = 1.0./vx1;
t29 = Cy12.*J2.*l12.*m1;
t30 = Cy12.*J2.*l12.*m2;
t31 = Cy13.*J2.*l13.*m1;
t32 = Cy13.*J2.*l13.*m2;
t33 = Cy21.*J1.*l21.*m1;
t34 = Cy21.*J1.*l21.*m2;
t35 = Cy22.*J1.*l22.*m1;
t36 = Cy22.*J1.*l22.*m2;
t37 = Cy23.*J1.*l23.*m1;
t38 = Cy23.*J1.*l23.*m2;
t45 = Cy21.*J1.*l2c1.*m1;
t46 = Cy22.*J1.*l2c1.*m1;
t47 = Cy23.*J1.*l2c1.*m1;
t48 = Cy21.*l21.*l2c1.*m2;
t49 = Cy22.*l22.*l2c1.*m2;
t50 = Cy23.*l23.*l2c1.*m2;
t15 = l21.*t12;
t16 = l22.*t13;
t17 = l23.*t14;
t18 = l2c1.*t12;
t19 = l2c1.*t13;
t20 = l2c1.*t14;
t27 = Cy11.*t23;
t28 = Cy11.*t24;
t39 = Cy11.*t25;
t40 = Cy12.*t25;
t41 = Cy13.*t25;
t42 = l1c1.*m1.*t12;
t43 = l1c1.*m1.*t13;
t44 = l1c1.*m1.*t14;
t57 = l2c1.*t34;
t58 = l2c1.*t36;
t59 = l2c1.*t38;
t65 = t29.*vy1;
t66 = t30.*vy1;
t67 = t31.*vy1;
t68 = t32.*vy1;
t80 = Cy11.*J2.*m1.*t2;
t81 = Cy11.*J2.*m2.*t2;
t82 = Cy12.*J2.*m1.*t3;
t83 = Cy12.*J2.*m2.*t3;
t84 = Cy13.*J2.*m1.*t4;
t85 = Cy13.*J2.*m2.*t4;
t86 = Cy21.*J1.*m1.*t5;
t87 = Cy21.*J1.*m2.*t5;
t88 = Cy22.*J1.*m1.*t6;
t89 = Cy22.*J1.*m2.*t6;
t90 = Cy23.*J1.*m1.*t7;
t91 = Cy23.*J1.*m2.*t7;
t92 = m1.*t8.*t12;
t93 = m1.*t8.*t13;
t94 = m1.*t8.*t14;
t95 = Cy21.*J1.*m1.*t10;
t96 = Cy22.*J1.*m1.*t10;
t97 = Cy23.*J1.*m1.*t10;
t98 = l2c1.*t33.*2.0;
t99 = l2c1.*t35.*2.0;
t100 = l2c1.*t37.*2.0;
t101 = Cy21.*l21.*m2.*t10;
t102 = Cy21.*l2c1.*m2.*t5;
t103 = Cy22.*l22.*m2.*t10;
t104 = Cy22.*l2c1.*m2.*t6;
t105 = Cy23.*l23.*m2.*t10;
t106 = Cy23.*l2c1.*m2.*t7;
t107 = J2.*m1.*m2.*t8;
t108 = J1.*m1.*m2.*t10;
t109 = l11.*m1.*m2.*t10;
t131 = l1c1.*m1.*t48;
t132 = l1c1.*m1.*t49;
t133 = l1c1.*m1.*t50;
t134 = -t33;
t135 = -t34;
t139 = -t49;
t140 = -t50;
t170 = Cy12.*l12.*m1.*m2.*t10;
t171 = Cy13.*l13.*m1.*m2.*t10;
t172 = Cy21.*l21.*m1.*m2.*t8;
t173 = Cy22.*l22.*m1.*m2.*t8;
t174 = Cy23.*l23.*m1.*m2.*t8;
t176 = m1.*t8.*t48;
t179 = m1.*t8.*t49;
t182 = m1.*t8.*t50;
t206 = Cy11.*m1.*m2.*t2.*t10;
t207 = Cy12.*m1.*m2.*t3.*t10;
t208 = Cy13.*m1.*m2.*t4.*t10;
t209 = Cy21.*m1.*m2.*t5.*t8;
t210 = Cy22.*m1.*m2.*t6.*t8;
t211 = Cy23.*m1.*m2.*t7.*t8;
t51 = l1c1.*t28;
t52 = l12.*t40;
t53 = l13.*t41;
t54 = l1c1.*m1.*t15;
t55 = l1c1.*m1.*t16;
t56 = l1c1.*m1.*t17;
t60 = l1c1.*m1.*t18;
t61 = l1c1.*m1.*t19;
t62 = l1c1.*m1.*t20;
t63 = t27.*vy1;
t64 = t28.*vy1;
t69 = t39.*vy1;
t70 = t40.*vy1;
t71 = t41.*vy1;
t72 = t42.*vy1;
t73 = t43.*vy1;
t74 = t44.*vy1;
t75 = -t16;
t76 = -t17;
t77 = -t18;
t78 = -t19;
t79 = -t20;
t125 = delta11.*t27.*vx1;
t126 = delta11.*t28.*vx1;
t127 = delta11.*t39.*vx1;
t128 = deltaPsi1.*t42.*vx1;
t129 = deltaPsi1.*t43.*vx1;
t130 = deltaPsi1.*t44.*vx1;
t136 = -t42;
t137 = -t43;
t138 = -t44;
t145 = -t98;
t146 = -t57;
t150 = t131.*vy1;
t151 = t132.*vy1;
t152 = t133.*vy1;
t153 = -t65;
t154 = -t66;
t155 = -t67;
t156 = -t68;
t160 = d_psi1.*t80;
t161 = d_psi1.*t81;
t162 = d_psi1.*t82;
t163 = d_psi1.*t83;
t164 = d_psi1.*t84;
t165 = d_psi1.*t85;
t166 = d_psi1.*t92;
t167 = d_psi1.*t93;
t168 = d_psi1.*t94;
t169 = Cy11.*t109;
t175 = l1c1.*m1.*t101;
t177 = l1c1.*m1.*t102;
t178 = l1c1.*m1.*t103;
t180 = l1c1.*m1.*t104;
t181 = l1c1.*m1.*t105;
t183 = l1c1.*m1.*t106;
t185 = t170.*vy1;
t186 = t171.*vy1;
t187 = -t101;
t196 = deltaPsi1.*t131.*vx1;
t197 = deltaPsi1.*t132.*vx1;
t198 = deltaPsi1.*t133.*vx1;
t205 = -t131;
t226 = -t172;
t230 = d_psi1.*t206;
t231 = d_psi1.*t207;
t232 = d_psi1.*t208;
t241 = t21+t22+t107+t108;
t243 = t12+t13+t14+t48+t139+t140;
t110 = d_deltaPsi1.*t54;
t111 = d_deltaPsi1.*t55;
t112 = d_deltaPsi1.*t56;
t113 = d_psi1.*t51;
t114 = d_psi1.*t52;
t115 = d_psi1.*t53;
t116 = d_psi1.*t54;
t117 = d_psi1.*t55;
t118 = d_psi1.*t56;
t119 = d_deltaPsi1.*t60;
t120 = d_deltaPsi1.*t61;
t121 = d_deltaPsi1.*t62;
t122 = d_psi1.*t60;
t123 = d_psi1.*t61;
t124 = d_psi1.*t62;
t141 = -t52;
t142 = -t53;
t143 = -t55;
t144 = -t56;
t147 = -t60;
t148 = -t61;
t149 = -t62;
t157 = -t72;
t158 = -t73;
t159 = -t74;
t184 = t169.*vy1;
t199 = -t125;
t200 = -t126;
t201 = -t127;
t202 = -t128;
t203 = -t129;
t204 = -t130;
t212 = -t150;
t213 = d_deltaPsi1.*t175;
t214 = d_deltaPsi1.*t177;
t215 = d_deltaPsi1.*t178;
t216 = d_deltaPsi1.*t180;
t217 = d_deltaPsi1.*t181;
t218 = d_deltaPsi1.*t183;
t219 = d_psi1.*t175;
t220 = d_psi1.*t177;
t221 = d_psi1.*t178;
t222 = d_psi1.*t180;
t223 = d_psi1.*t181;
t224 = d_psi1.*t183;
t225 = delta11.*t169.*vx1;
t227 = -t175;
t228 = -t185;
t229 = -t186;
t233 = -t196;
t242 = 1.0./t241;
t244 = t15+t75+t76+t77+t78+t79+t102+t103+t104+t105+t106+t187;
t188 = -t111;
t189 = -t112;
t190 = -t114;
t191 = -t115;
t192 = -t116;
t193 = -t119;
t194 = -t120;
t195 = -t121;
t234 = -t213;
t235 = -t220;
t236 = -t221;
t237 = -t222;
t238 = -t223;
t239 = -t224;
t240 = -t225;
dotX = [-t26.*t242.*(t51.*vy1+t57.*vy1-t58.*vy1-t59.*vy1+t141.*vy1+t142.*vy1-J1.*d_deltaPsi1.*t15+J1.*d_deltaPsi1.*t16+J1.*d_deltaPsi1.*t17+J1.*d_deltaPsi1.*t18+J1.*d_deltaPsi1.*t19+J1.*d_deltaPsi1.*t20+J1.*d_psi1.*t15+J1.*d_psi1.*t75+J1.*d_psi1.*t76+J1.*d_psi1.*t77+J1.*d_psi1.*t78+J1.*d_psi1.*t79+J1.*t12.*vy1+J1.*t13.*vy1+J1.*t14.*vy1-d_deltaPsi1.*l2c1.*t87-d_deltaPsi1.*l2c1.*t89-d_deltaPsi1.*l2c1.*t91+d_psi1.*l1c1.*t58+d_psi1.*l1c1.*t59+d_psi1.*l2c1.*t87+d_psi1.*l2c1.*t89+d_psi1.*l2c1.*t91+d_psi1.*l1c1.*t146+d_deltaPsi1.*t10.*t34-d_deltaPsi1.*t10.*t36-d_deltaPsi1.*t10.*t38+d_psi1.*t11.*t21+d_psi1.*t11.*t22+d_psi1.*t8.*t28-d_psi1.*t8.*t30-d_psi1.*t8.*t32+d_psi1.*t2.*t39+d_psi1.*t3.*t40+d_psi1.*t4.*t41+d_psi1.*t10.*t36+d_psi1.*t10.*t38+d_psi1.*t11.*t107+d_psi1.*t11.*t108+d_psi1.*t10.*t135-delta11.*t51.*vx1+deltaPsi1.*t57.*vx1-deltaPsi1.*t58.*vx1-deltaPsi1.*t59.*vx1+Cy11.*J1.*J2.*vy1+Cy12.*J1.*J2.*vy1+Cy13.*J1.*J2.*vy1-J1.*d_psi1.*l1c1.*t12-J1.*d_psi1.*l1c1.*t13-J1.*d_psi1.*l1c1.*t14+J1.*deltaPsi1.*t12.*vx1+J1.*deltaPsi1.*t13.*vx1+J1.*deltaPsi1.*t14.*vx1+Cy11.*J1.*J2.*d_psi1.*l11-Cy12.*J1.*J2.*d_psi1.*l12-Cy13.*J1.*J2.*d_psi1.*l13-Cy11.*J1.*J2.*delta11.*vx1+Cy11.*J2.*m2.*t8.*vy1+Cy11.*J1.*m2.*t10.*vy1+Cy12.*J2.*m2.*t8.*vy1+Cy12.*J1.*m2.*t10.*vy1+Cy13.*J2.*m2.*t8.*vy1+Cy13.*J1.*m2.*t10.*vy1+Cy11.*J1.*d_psi1.*l11.*m2.*t10-Cy12.*J1.*d_psi1.*l12.*m2.*t10-Cy13.*J1.*d_psi1.*l13.*m2.*t10-Cy11.*J2.*delta11.*m2.*t8.*vx1-Cy11.*J1.*delta11.*m2.*t10.*vx1);-t26.*t242.*(t63+t64+t69+t70+t71+t110+t113+t117+t118+t122+t123+t124+t151+t152+t153+t154+t155+t156+t157+t158+t159+t160+t161+t162+t163+t164+t165+t166+t167+t168+t184+t188+t189+t190+t191+t192+t193+t194+t195+t197+t198+t199+t200+t201+t202+t203+t204+t212+t214+t215+t216+t217+t218+t219+t228+t229+t230+t231+t232+t233+t234+t235+t236+t237+t238+t239+t240+d_psi1.*t176+d_psi1.*m1.*t8.*t139+d_psi1.*m1.*t8.*t140);-t26.*t242.*(t63+t64+t69+t70+t71+t110+t113+t117+t118+t122+t123+t124+t151+t152+t153+t154+t155+t156+t157+t158+t159+t160+t161+t162+t163+t164+t165+t166+t167+t168+t184+t188+t189+t190+t191+t192+t193+t194+t195+t197+t198+t199+t200+t201+t202+t203+t204+t212+t214+t215+t216+t217+t218+t219+t228+t229+t230+t231+t232+t233+t234+t235+t236+t237+t238+t239+t240+d_deltaPsi1.*t58+d_deltaPsi1.*t59+d_deltaPsi1.*t86+d_deltaPsi1.*t87+d_deltaPsi1.*t88+d_deltaPsi1.*t89+d_deltaPsi1.*t90+d_deltaPsi1.*t91+d_deltaPsi1.*t95+d_deltaPsi1.*t96+d_deltaPsi1.*t97+d_deltaPsi1.*t99+d_deltaPsi1.*t100+d_deltaPsi1.*t146-d_deltaPsi1.*t176+d_deltaPsi1.*t179+d_deltaPsi1.*t182+d_deltaPsi1.*t209+d_deltaPsi1.*t210+d_deltaPsi1.*t211+d_psi1.*t57-d_psi1.*t58-d_psi1.*t59-d_psi1.*t86-d_psi1.*t87-d_psi1.*t88-d_psi1.*t89-d_psi1.*t90-d_psi1.*t91-d_psi1.*t95-d_psi1.*t96-d_psi1.*t97+d_psi1.*t98+d_psi1.*t176.*2.0-d_psi1.*t179.*2.0-d_psi1.*t182.*2.0-d_psi1.*t209-d_psi1.*t210-d_psi1.*t211+t35.*vy1+t36.*vy1+t37.*vy1+t38.*vy1+t45.*vy1+t46.*vy1+t47.*vy1+t134.*vy1+t135.*vy1+t173.*vy1+t174.*vy1+t226.*vy1-d_deltaPsi1.*l2c1.*t33.*2.0+d_psi1.*l1c1.*t33+d_psi1.*l1c1.*t34-d_psi1.*l1c1.*t35-d_psi1.*l1c1.*t36-d_psi1.*l1c1.*t37-d_psi1.*l1c1.*t38-d_psi1.*l1c1.*t45-d_psi1.*l2c1.*t35.*2.0-d_psi1.*l1c1.*t46-d_psi1.*l1c1.*t47-d_psi1.*l2c1.*t37.*2.0+deltaPsi1.*t35.*vx1+deltaPsi1.*t36.*vx1+deltaPsi1.*t37.*vx1+deltaPsi1.*t38.*vx1+deltaPsi1.*t45.*vx1+deltaPsi1.*t46.*vx1+deltaPsi1.*t47.*vx1+deltaPsi1.*t134.*vx1+deltaPsi1.*t135.*vx1+deltaPsi1.*t173.*vx1+deltaPsi1.*t174.*vx1+deltaPsi1.*t226.*vx1-Cy11.*J1.*l2c1.*m2.*vy1-Cy12.*J1.*l2c1.*m2.*vy1-Cy13.*J1.*l2c1.*m2.*vy1-Cy11.*J1.*d_psi1.*l11.*l2c1.*m2+Cy12.*J1.*d_psi1.*l12.*l2c1.*m2+Cy13.*J1.*d_psi1.*l13.*l2c1.*m2+Cy11.*J1.*delta11.*l2c1.*m2.*vx1+Cy21.*d_psi1.*l21.*m1.*m2.*t9-Cy22.*d_psi1.*l22.*m1.*m2.*t9-Cy23.*d_psi1.*l23.*m1.*m2.*t9+Cy11.*d_psi1.*l1c1.*l2c1.*m1.*m2.*t2+Cy12.*d_psi1.*l1c1.*l2c1.*m1.*m2.*t3+Cy13.*d_psi1.*l1c1.*l2c1.*m1.*m2.*t4+Cy11.*l11.*l1c1.*l2c1.*m1.*m2.*vy1-Cy12.*l12.*l1c1.*l2c1.*m1.*m2.*vy1-Cy13.*l13.*l1c1.*l2c1.*m1.*m2.*vy1-Cy11.*delta11.*l11.*l1c1.*l2c1.*m1.*m2.*vx1);d_psi1;d_deltaPsi1];
if nargout > 1
    A = reshape([-t26.*t242.*(t51+t57-t58-t59+t141+t142+J1.*t12+J1.*t13+J1.*t14+Cy11.*J1.*J2+Cy12.*J1.*J2+Cy13.*J1.*J2+Cy11.*J2.*m2.*t8+Cy11.*J1.*m2.*t10+Cy12.*J2.*m2.*t8+Cy12.*J1.*m2.*t10+Cy13.*J2.*m2.*t8+Cy13.*J1.*m2.*t10),t26.*t242.*(-t27-t28+t29+t30+t31+t32-t39-t40-t41+t42+t43+t44+t131-t132-t133-t169+t170+t171),-t26.*t242.*(t27+t28-t29-t30-t31-t32+t35+t36+t37+t38+t39+t40+t41+t45+t46+t47+t132+t133+t134+t135+t136+t137+t138+t169-t170-t171+t173+t174+t205+t226-Cy11.*J1.*l2c1.*m2-Cy12.*J1.*l2c1.*m2-Cy13.*J1.*l2c1.*m2+Cy11.*l11.*l1c1.*l2c1.*m1.*m2-Cy12.*l12.*l1c1.*l2c1.*m1.*m2-Cy13.*l13.*l1c1.*l2c1.*m1.*m2),0.0,0.0,-t26.*t242.*(J1.*t15+J1.*t75+J1.*t76+J1.*t77+J1.*t78+J1.*t79+l1c1.*t58+l1c1.*t59+l2c1.*t87+l2c1.*t89+l2c1.*t91+l1c1.*t146+t11.*t21+t11.*t22+t8.*t28-t8.*t30-t8.*t32+t2.*t39+t3.*t40+t4.*t41+t10.*t36+t10.*t38+t11.*t107+t11.*t108+t10.*t135-J1.*l1c1.*t12-J1.*l1c1.*t13-J1.*l1c1.*t14+Cy11.*J1.*J2.*l11-Cy12.*J1.*J2.*l12-Cy13.*J1.*J2.*l13+Cy11.*J1.*l11.*m2.*t10-Cy12.*J1.*l12.*m2.*t10-Cy13.*J1.*l13.*m2.*t10),-t26.*t242.*(t51-t54+t55+t56+t60+t61+t62+t80+t81+t82+t83+t84+t85+t92+t93+t94+t141+t142+t175+t176-t177-t178-t180-t181-t183+t206+t207+t208+m1.*t8.*t139+m1.*t8.*t140),t26.*t242.*(-t51+t52+t53+t54+t58+t59-t80-t81-t82-t83-t84-t85+t86+t87+t88+t89+t90+t91-t92-t93-t94+t95+t96+t97+t99+t100+t143+t144+t145+t146+t147+t148+t149-t176.*2.0+t177+t178+t179.*2.0+t180+t181+t182.*2.0+t183-t206-t207-t208+t209+t210+t211+t227+l1c1.*t35+l1c1.*t36+l1c1.*t37+l1c1.*t38+l1c1.*t45+l1c1.*t46+l1c1.*t47+l1c1.*t134+l1c1.*t135+Cy11.*J1.*l11.*l2c1.*m2-Cy12.*J1.*l12.*l2c1.*m2-Cy13.*J1.*l13.*l2c1.*m2-Cy21.*l21.*m1.*m2.*t9+Cy22.*l22.*m1.*m2.*t9+Cy23.*l23.*m1.*m2.*t9-Cy11.*l1c1.*l2c1.*m1.*m2.*t2-Cy12.*l1c1.*l2c1.*m1.*m2.*t3-Cy13.*l1c1.*l2c1.*m1.*m2.*t4),1.0,0.0,J1.*t26.*t242.*t244,-l1c1.*m1.*t26.*t242.*t244,-t26.*t242.*(t54+t58+t59+t86+t87+t88+t89+t90+t91+t95+t96+t97+t99+t100+t143+t144+t145+t146+t147+t148+t149-t176+t177+t178+t179+t180+t181+t182+t183+t209+t210+t211+t227),0.0,1.0,0.0,0.0,0.0,0.0,0.0,-J1.*t242.*t243,l1c1.*m1.*t242.*t243,-t242.*(t35+t36+t37+t38+t45+t46+t47+t132+t133+t134+t135+t136+t137+t138+t173+t174+t205+t226),0.0,0.0],[5,5]);
end
if nargout > 2
    B = [Cy11.*t242.*(l1c1.*t24+J1.*J2+J2.*m2.*t8+J1.*m2.*t10);Cy11.*t242.*(t23+t24+t25+t109);Cy11.*t242.*(t23+t24+t25+t109-J1.*l2c1.*m2+l11.*l1c1.*l2c1.*m1.*m2);0.0;0.0];
end
